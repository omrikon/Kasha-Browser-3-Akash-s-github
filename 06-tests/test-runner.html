<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasha Browser Game - Test Runner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .test-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .run-all-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .run-all-btn:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
        
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .summary-card h3 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .summary-card .value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .passed {
            color: #4ade80;
        }
        
        .failed {
            color: #f87171;
        }
        
        .duration {
            color: #60a5fa;
        }
        
        .test-results {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .test-results h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .test-failure {
            background: rgba(248, 113, 113, 0.2);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #f87171;
        }
        
        .test-summary {
            background: rgba(96, 165, 250, 0.2);
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            border-left: 4px solid #60a5fa;
        }
        
        .console-output {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .console-output::-webkit-scrollbar {
            width: 8px;
        }
        
        .console-output::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        .console-output::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }
        
        .console-output::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Game Test Suite</h1>
        
        <div class="test-controls">
            <button class="run-all-btn" onclick="runAllTests()">Run All Tests</button>
        </div>
        
        <div class="summary">
            <div class="summary-card">
                <h3>Tests Passed</h3>
                <div class="value passed" id="tests-passed">0</div>
            </div>
            <div class="summary-card">
                <h3>Tests Failed</h3>
                <div class="value failed" id="tests-failed">0</div>
            </div>
            <div class="summary-card">
                <h3>Duration</h3>
                <div class="value duration" id="test-duration">0ms</div>
            </div>
        </div>
        
        <div class="test-results" id="test-results">
            <h3>Test Results</h3>
            <p>Click "Run All Tests" to run the test suite.</p>
        </div>
        
        <div class="console-output" id="console-output"></div>
    </div>

    <!-- Load game files in order (same as main game) -->
    <script src="../01-core/config.js"></script>
    <script src="../01-core/gameState.js"></script>
    <script src="../02-systems/audio.js"></script>
    <script src="../02-systems/input.js"></script>
    <script src="../02-systems/drawing.js"></script>
    <script src="../02-systems/gameLoop.js"></script>
    <script src="../02-systems/level.js"></script>
    <script src="../05-world/tilemap.js"></script>
    <script src="../03-classes/effects.js"></script>
    <script src="../03-classes/gameObjects.js"></script>
    <script src="../03-classes/inventory.js"></script>
    <script src="../03-classes/particles.js"></script>
    <script src="../03-classes/player.js"></script>
    <script src="../04-creatures/enemies/maroon_blob_enemy_1.js"></script>
    <script src="../04-creatures/kashas/cassieduck.js"></script>
    
    <!-- Load test framework and test files -->
    <script src="test-framework.js"></script>
    <script src="01-core-tests.js"></script>
    <script src="02-systems-audio-tests.js"></script>
    <script src="02-systems-input-tests.js"></script>
    <script src="02-systems-drawing-tests.js"></script>
    <script src="02-systems-gameloop-tests.js"></script>
    <script src="02-systems-level-tests.js"></script>
    <script src="03-classes-player-tests.js"></script>
    <script src="03-classes-inventory-tests.js"></script>
    <script src="03-classes-gameObjects-tests.js"></script>
    <script src="03-classes-effects-tests.js"></script>
    <script src="03-classes-particles-tests.js"></script>
    <script src="04-creatures-tests.js"></script>
    <script src="05-world-tests.js"></script>
    <script src="integration-tests.js"></script>
    
    <script>
        // Capture console output
        const consoleOutput = document.getElementById('console-output');
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToConsole(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'warn' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            consoleOutput.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole(args.join(' '), 'warn');
        };
        
        // Run all tests function
        function runAllTests() {
            consoleOutput.textContent = 'Running all tests...\n\n';
            window.testStartTime = Date.now();
            
            // Reset counters in test framework
            if (typeof testsPassed !== 'undefined') {
                testsPassed = 0;
                testsFailed = 0;
                failedTests = [];
                testResults = [];
            }
            
            try {
                // Initialize game if needed
                if (typeof initAudio === 'function') {
                    initAudio();
                }
                
                // Run all test suites
                if (typeof runAllCoreTests === 'function') runAllCoreTests();
                if (typeof runAllAudioTests === 'function') runAllAudioTests();
                if (typeof runAllInputTests === 'function') runAllInputTests();
                if (typeof runAllDrawingTests === 'function') runAllDrawingTests();
                if (typeof runAllGameLoopTests === 'function') runAllGameLoopTests();
                if (typeof runAllLevelTests === 'function') runAllLevelTests();
                if (typeof runAllPlayerTests === 'function') runAllPlayerTests();
                if (typeof runAllInventoryTests === 'function') runAllInventoryTests();
                if (typeof runAllGameObjectTests === 'function') runAllGameObjectTests();
                if (typeof runAllEffectTests === 'function') runAllEffectTests();
                if (typeof runAllParticleTests === 'function') runAllParticleTests();
                if (typeof runAllCreatureTests === 'function') runAllCreatureTests();
                if (typeof runAllWorldTests === 'function') runAllWorldTests();
                if (typeof runAllIntegrationTests === 'function') runAllIntegrationTests();
                
                // Generate summary
                const endTime = Date.now();
                const duration = endTime - window.testStartTime;
                
                console.log('\n' + '='.repeat(50));
                console.log('üìä TEST SUMMARY');
                console.log('='.repeat(50));
                console.log(`‚úÖ Passed: ${testsPassed}`);
                console.log(`‚ùå Failed: ${testsFailed}`);
                console.log(`‚è±Ô∏è  Duration: ${duration}ms`);
                console.log(`üìà Total Tests: ${testsPassed + testsFailed}`);
                
                // Update HTML display
                updateTestResults();
                document.getElementById('test-duration').textContent = duration + 'ms';
                
                console.log('\n‚úÖ All test suites completed!');
            } catch (error) {
                console.error('Error running tests:', error);
            }
        }
        
        console.log('Test runner loaded. Click "Run All Tests" to start.');
    </script>
</body>
</html>
